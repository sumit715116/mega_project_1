
CRM_CUSTOMER  ----  BUT000

/*"+ projectName +" "+jobName+" */
/** Update EDW..CRM_CUSTOMER**/
UPDATE CRM_CUSTOMER SET CUST_DELETE_TS = CURRENT_DATE - 1
WHERE cust_delete_ts is null
	and  SAP_BP_ID 
not in 
(
   SELECT partner
   FROM "+context.NTZ_STG_CRM+"..but000
	WHERE LENGTH(TRANSLATE(but000.partner,'1234567890', '')) = 0
)

-----------------------------------------------------------------------------

/*"+ projectName +" "+jobName+" */
/** Delete from EDW..CRM_CUSTOMER**/
DELETE FROM CRM_CUSTOMER
WHERE EXISTS (SELECT 1 FROM "+context.NTZ_STG_CRM+"..BUT000
			WHERE CRM_CUSTOMER.SAP_BP_ID = TRIM(LEADING '0' FROM BUT000.PARTNER)
			AND LENGTH(TRANSLATE(BUT000.PARTNER, '1234567890','')) = 0	
			AND BUT000.DB_TS >=  to_timestamp(" + TalendDate.formatDate("yyyyMMddHHmmss",context.ctxFromDate) + " ,'yyyyMMddHHmiss'))

-----------------------------------------------------------------------------

/*"+ projectName +" "+jobName+" */
/* Insert Data into EDW CRM_Customer Table*/
/*DIA-8470 CUST_VETEREN is fetching from STG_CRM..CUSTOMER_ATTRIBUTES*/
INSERT INTO CRM_CUSTOMER (
    POS_CUST_ID,
    ECOMM_CUST_ID,
    SAP_BP_ID,
    EMPL_ID	,
    HH_ID	,
    CL_CUST_ID	,
    MDB_ID	,
    CUST_CAT_CODE	,
    CUST_TYPE_CODE	,
    CUST_EXTERNAL_ID	,
    CUST_SRC_CODE	,
    CUST_TITLE	,
    CUST_DELETE_FLAG	,
    CUST_BLOCK	,
    CUST_CONTACT_IND	,
    CUST_EMPL_HIRE_DATE	,
    CUST_EMPL_TERMINATION_DATE	,
    CUST_EMPL_ACTV_FLAG	,
    CUST_EMPL_STORE	,
    CUST_EMPL_EFF_DATE	,
    CUST_HOME_ADDR_SRC_DATE	,
    CUST_CARRIER_ROUTE	,
    CUST_DBPC	,
    CUST_RETURNED	,
    CUST_PENETRATION_CODE	,
    CUST_PENETRATION_CAT	,
    CUST_DECEASED_IND	,
    CUST_TSC_FIRST_PURCH_DATE	,
    CUST_TSC_FIRST_PURCH_DAYS	,
    CUST_TSC_FIRST_PURCH_TRANS_NO	,
    CUST_TSC_FIRST_PURCH_STORE_NO	,
    CUST_TSC_FIRST_PURCH_AMT	,
    CUST_TSC_LAST_PURCH_DATE	,
    CUST_TSC_LAST_PURCH_DAYS	,
    CUST_TSC_LAST_PURCH_TRANS_NO	,
    CUST_TSC_LAST_PURCH_STORE_NO	,
    CUST_TSC_LAST_PURCH_AMT	,
    CUST_TSC_HAND_RAISE_IND	,
    CUST_TSC_MAIN_STORE_NO	,
    CUST_TSC_LIFE_PURCH_AMT	,
    CUST_TSC_LIFE_TRANS_COUNT	,
    CUST_TSC_LIFE_TRANS_LINE_COUNT	,
    CUST_TSC_RETURN_AMT	,
    CUST_TSC_RETURN_TRANS_COUNT	,
    CUST_TSC_RETURN_TRANS_LINE_COUNT	,
    CUST_HTP_FIRST_PURCH_DATE	,
    CUST_HTP_FIRST_PURCH_DAYS	,
    CUST_HTP_FIRST_PURCH_STORE_NO	,
    CUST_HTP_FIRST_PURCH_AMT	,
    CUST_HTP_LAST_PURCH_DATE	,
    CUST_HTP_LAST_PURCH_DAYS	,
    CUST_HTP_LAST_PURCH_STORE_NO	,
    CUST_HTP_LAST_PURCH_AMT	,
    CUST_HTP_MAIN_STORE_NO	,
    CUST_HTP_LIFE_PURCH_AMT	,
    CUST_HTP_LIFE_TRANS_COUNT	,
    CUST_HTP_LIFE_TRANS_LINE_COUNT	,
    CUST_HTP_RETURN_AMT	,
    CUST_HTP_RETURN_TRANS_COUNT	,
    CUST_HTP_RETURN_TRANS_LINE_COUNT	,
    CUST_DNC_EMAIL_IND	,
    CUST_DNC_EMAIL_DATE	,
    CUST_CHILDREN_IND	,
    CUST_NAICS_CODE	,
    CUST_NAICS_DESC	,
    HH_FREQ	,
    HH_FIRST_PURCH_DATE	,
    HH_LAST_PURCH_DATE	,
    HH_CONTROL_GROUP_2012H1	,
    HH_CONTROL_GROUP_2012H2	,
    HH_CONTROL_GROUP_2013H1	,
    HH_CONTROL_GROUP_2013H2	,
    HH_CONTROL_GROUP_2014H2	,
    HH_CONTROL_GROUP_2015H2	,
    HH_CONTROL_GROUP_2016H1	,
    CUST_TSC_CLOSEST_STORE_NO	,
    CUST_TSC_1_365_TRANS_COUNT	,
    CUST_TSC_1_180_TRANS_COUNT	,
    CUST_TSC_181_365_TRANS_COUNT	,
    CUST_TSC_366_546_TRANS_COUNT	,
    CUST_TSC_366_730_TRANS_COUNT	,
    CUST_TSC_1_365_SALES_AMT	,
    CUST_HTP_CLOSEST_STORE_NO	,
    CUST_HTP_1_365_TRANS_COUNT	,
    CUST_HTP_1_180_TRANS_COUNT	,
    CUST_HTP_181_365_TRANS_COUNT	,
    CUST_HTP_366_546_TRANS_COUNT	,
    CUST_HTP_366_730_TRANS_COUNT	,
    CUST_HTP_1_365_SALES_AMT	,
    CUST_FF_IND	,
    CUST_NC_IND	,
    CUST_CONSUMER_CARD_IND	,
    CUST_BUS_CARD_IND	,
    CUST_LEGACY_HH_ID	,
    CUST_FIRST_SRC_NAME	,
    HH_ACTV_BANK_CARD_IND	,
    CUST_ACTV_BANK_CARD_IND	,
    HH_ADULT_COUNT	,
    HH_ADULT_FEMALE_COUNT	,
    HH_ADULT_MALE_COUNT	,
    HH_CHILD_COUNT	,
    CUST_AGE	,
    CUST_BANK_CARD_IND	,
    CUST_CAMPING_IND	,
    CUST_CAR_IND	,
    CUST_CAT_OWNER_IND	,
    CUST_RETAIL_CREDIT_CARD_IND	,
    CUST_DMA_CODE	,
    CUST_DMA_AREA	,
    CUST_DOG_OWNER_IND	,
    CUST_INCOME_RANK	,
    CUST_FAMILY_ID	,
    CUST_FISHING_IND	,
    CUST_GARDEN_IND	,
    HH_INCOME_ESTIMATE	,
    HH_FAMILY_INCOME_DET_CD	,
    HH_FAMILY_INCOME_DET_RG	,
    CUST_INDV_ID	,
    CUST_GENDER_CODE	,
    CUST_HEAD_OF_HH_IND	,
    CUST_HEATING_TYPE	,
    CUST_HOME_OWNER_FLAG	,
    CUST_HUNTING_IND	,
    CUST_LENGTH_OF_RESIDENCE	,
    CUST_LHI_APPAREL_IND	,
    CUST_LHI_APPAREL_MEN_IND	,
    CUST_LHI_APPAREL_WOMEN_IND	,
    CUST_LHI_AUTO_IND	,
    CUST_LHI_AUTO_RACING_IND	,
    CUST_LHI_TRUCKS_IND	,
    CUST_LHI_BIRDS_IND	,
    CUST_LHI_DIY_IND	,
    CUST_LHI_DONOR_IND	,
    CUST_LHI_EQUESTRIAN_IND	,
    CUST_LHI_GARDENING_IND	,
    CUST_LHI_INTERNET_IND	,
    CUST_LHI_CAMPING_IND	,
    CUST_LHI_FISHING_IND	,
    CUST_LHI_HUNTING_IND	,
    CUST_LHI_PETS_IND	,
    CUST_LHI_CATS_IND	,
    CUST_LHI_DOGS_IND	,
    CUST_LHI_RURAL_IND	,
    CUST_LHI_OUTDOOR_IND	,
    CUST_LOT_SIZE	,
    CUST_PREVIOUS_MAIL_RESPONSE_IND	,
    CUST_MARITAL_STATUS_IND	,
    CUST_0_17_MKT	,
    CUST_18_24F_MKT	,
    CUST_18_24M_MKT	,
    CUST_25_34F_MKT	,
    CUST_25_34M_MKT	,
    CUST_45_54F_MKT	,
    CUST_45_54M_MKT	,
    CUST_55_64F_MKT	,
    CUST_55_64M_MKT	,
    CUST_65_UP_MKT	,
    HH_1_2_MKT	,
    HH_3_UP_MKT	,
    CUST_OUTDOOR_IND	,
    CUST_OUTDOOR_GARDEN_IND	,
    CUST_PET_IND	,
    CUST_PRIZM_CODE	,
    CUST_PROPERTY_TYPE	,
    CUST_TR_ATV_IND	,
    CUST_TR_ACM_IND	,
    CUST_TR_CAT_IND	,
    CUST_TR_CCRW_IND	,
    CUST_TR_DOG_IND	,
    CUST_TR_GARDEN_IND	,
    CUST_TR_COUPON_IND	,
    CUST_TR_HUNTING_IND	,
    CUST_TR_MOBILE_IND	,
    CUST_TR_NASCAR_IND	,
    CUST_TR_ONLINE_B_IND	,
    CUST_TR_ONLINE_P_IND	,
    CUST_TR_SOCIAL_IND	,
    CUST_2010_STATE_CODE	,
    CUST_2010_COUNTY_CODE	,
    CUST_2010_TRACT_CODE	,
    CUST_2010_BG_CODE	,
    CUST_CHILDREN_BY_AGE	,
    CUST_CLUSTER_SPECTRUM	,
    CUST_ETHNIC_GROUP	,
    CUST_ETHNICITY	,
    CUST_LANGUAGE_CODE	,
    CUST_HOME_VALUE_CODE	,
    CUST_TSC_CLEANSE_STATUS	,
    CUST_NC_WELCOME_STRING	,
    CUST_NC_WELCOME_COUNT	,
    CUST_NC_WELCOME_ACTION_RANGE	,
    CUST_NC_UNENROLL_STRING	,
    CUST_NC_UNENROLL_COUNT	,
    CUST_NC_UNENROLL_ACTION_RANGE	,
    CUST_NC_UNDO_UNENROLL_ACTION	,
    CUST_NC_UNDO_UNENROLL_COUNT	,
    CUST_NC_UNDO_UNENROLL_ACTION_RANGE	,
    CUST_FF_WELCOME_ACTION	,
    CUST_FF_WELCOME_COUNT	,
    CUST_FF_WELCOME_ACTION_RANGE	,
    CUST_FF_UNENROLL_STRING	,
    CUST_FF_UNENROLL_COUNT	,
    CUST_FF_UNENROLL_ACTION_RANGE	,
    CUST_FF_UNDO_UNENROLL_ACTION	,
    CUST_FF_UNDO_UNENROLL_COUNT	,
    CUST_FF_UNDO_UNENROLL_ACTION_RANGE	,
    CUST_ECOMM_OPT_IN_ACTION	,
    CUST_ECOMM_OPT_IN_COUNT	,
    CUST_ECOMM_OPT_IN_ACTION_RANGE	,
    CUST_ECOMM_OPT_OUT_ACTION	,
    CUST_ECOMM_OPT_OUT_COUNT	,
    CUST_ECOMM_OPT_OUT_ACTION_RANGE	,
    CUST_ECOMM_UNDO_OPT_OUT_ACTION	,
    CUST_ECOMM_UNDO_OPT_OUT_COUNT	,
    CUST_ECOMM_UNDO_OPT_OUT_ACTION_RANGE	,
    CUST_TAX_EXEMPT_IND	,
    CUST_MOSAIC_CODE	,
    CUST_MOSAIC_DESC	,
    CUST_CL_RESN_ADDR_STD	,
    CUST_CL_RESN_NAME_STD	,
    CUST_CL_RESN_NCOA	,
    CUST_CL_RESN_LOC_APPEND	,
    CUST_CL_RESN_ZIP_CODE_APPEND	,
    CUST_CL_RESN_PHONE_APPEND	,
    CUST_CL_RESN_EMAIL_APPEND	,
    CUST_CL_RESN_PHONE_STD	,
    CUST_CL_RESN_EMAIL_STD	,
    CUST_CL_RESN_SUPPRESS_APPEND	,
    CUST_CL_RESN_MOSAIC_APPEND	,
    CUST_CL_RESN_BUS_APPEND	,
    CUST_CL_RESN_CONSUMER_APPEND	,
    CUST_DO_NOT_UPD_NAME	,
    CUST_DO_NOT_UPD_HH	,
    CUST_DO_NOT_UPD_ADDR	,
    CUST_CL_VULGAR_FLAG	,
    CUST_CL_VACANT	,
    CUST_CL_TRAILER_PARK	,
    CUST_CL_PRISON	,
    CUST_CL_NURSING	,
    CUST_CL_MILITARY	,
    CUST_DNC_WORK	,
    CUST_DNC_HOME	,
    CUST_DNC_MOBILE	,
    CUST_DNC_OTHER	,
    CUST_DNC_MAIL	,
    CUST_DNC_MAIL_DATE	,
    CUST_REQUEST_TYPE	,
    CUST_SUITE_LINK_MATCH	,
    CUST_RESIDENCE_DELIV	,
    CUST_SIC_LIST	,
    CUST_SIC_CODE	,
    CUST_BUS_TYPE	,
    CUST_LACSLINK_IND	,
    CUST_LACSLINK_CODE	,
    CUST_NCOA_MOVE_DATE	,
    CUST_CL_DELIV_POINT	,
    CUST_CL_DPV_MATCH_CODE	,
    CUST_CL_DPV_NOTE	,
    CUST_CL_DPV_RECORD_TYPE	,
    CUST_CL_CMRA	,
    CUST_BUS_LOC	,
    CUST_BUS_SALES	,
    CUST_BUS_SIZE	,
    CUST_CO_SALES	,
    CUST_CO_SIZE	,
    CUST_MOSAIC_4_CODE	,
    CUST_MOSAIC_4_DESC	,
    CUST_DISTB_CHAN	,
    CUST_REGION_DIV	,
    CUST_REGION_NO	,
    CUST_DIST_NO	,
    CUST_COMP_STORE	,
    CUST_STORE_SQUARE_FEET	,
    CUST_DIST_NAME	,
    CUST_STORE_LAYOUT	,
    CUST_TITLE_CODE	,
    CUST_TITLE_DESC	,
    CUST_EVENT_ID	,
    CUST_EVENT_TYPE	,
    CUST_EVENT_DATE	,
    CUST_DIRECT_MAIL_IND	,
    CUST_EMAIL_IND	,
    CUST_TRANS_NO	,
    CUST_PRICE_ZONE	,
    CUST_TSC_SUPPRESS_FLAG	,
    CUST_EMAIL_VALID_FLAG	,
    CUST_ORG_NAME_1	,
    CUST_ORG_NAME_2	,
    CUST_ORG_NAME_3	,
    CUST_ORG_NAME_4	,
    CUST_ORG_FORM	,
    CUST_INDUSTRY_SECTOR	,
    CUST_LEGAL_ORG	,
    CUST_ORG_FOUNDED_DATE	,
    CUST_ORG_LIQUIDATION_DATE	,
    CUST_LOC_1	,
    CUST_LOC_2	,
    CUST_LOC_3	,
    CUST_LAST_NAME	,
    CUST_FIRST_NAME	,
    CUST_LAST_NAME_2	,
    CUST_BIRTH_NAME	,
    CUST_MIDDLE_NAME	,
    CUST_ACADEMIC_TITLE_1	,
    CUST_ACADEMIC_TITLE_2	,
    CUST_TITLE_SUPPLEMENT	,
    CUST_PREFIX_1	,
    CUST_PREFIX_2	,
    CUST_FULL_NAME	,
    CUST_NICKNAME	,
    CUST_INITIALS	,
    CUST_NAME_FORMAT	,
    CUST_NAME_FORMAT_COUNTRY	,
    CUST_CORRESPONDENCE_LANGUAGE	,
    CUST_GENDER_MALE	,
    CUST_GENDER_FEMALE	,
    CUST_BIRTHPLACE	,
    CUST_MARITAL_STATUS	,
    CUST_EMPLOYER	,
    CUST_OCCUPATION	,
    CUST_NATIONALITY	,
    CUST_CITY_OF_ORIGIN	,
    CUST_GENDER_UNKNOWN	,
    CUST_LANGUAGE	,
    CUST_DOB	,
    CUST_BIRTHDAY	,
    CUST_DATE_OF_DEATH	,
    CUST_GROUP_TYPE	,
    CUST_GROUP_NAME_1	,
    CUST_GROUP_NAME_2	,
    CUST_CREATE_USER	,
    CUST_CREATE_TS	,
    CUST_UPD_USER	,
    CUST_UPD_TS	,
    CUST_GUID	,
    CUST_PRIMARY_ADDR_ID	,
    CUST_EFF_TS	,
    CUST_END_TS	,
    CUST_INDV_IND,
	CUST_DELETE_TS,
	CUST_HIGH_ISSUE_FLAG,
    CUST_VETERAN
)	
WITH PARTNER_REF AS 
	(
        SELECT X.PARTNER, 
            X.POS_CUST_ID, 
            X.ECOMM_CUST_ID, 
            X.CL_CUST_ID, 
            X.MDB_ID, 
            X.CLN_HH_ID, 
            Y.PARTNER HH_ID
        FROM (SELECT PARTNER,
                MAX(CASE WHEN ID_TYPE = 'ZPOS' THEN IDNUMBER ELSE NULL END) POS_CUST_ID,
                MAX(CASE WHEN ID_TYPE = 'ZWCS' THEN IDNUMBER ELSE NULL END ) ECOMM_CUST_ID,
                MAX(CASE WHEN ID_TYPE = 'ZCLEAN' THEN IDNUMBER ELSE NULL END) CL_CUST_ID,
                MAX(CASE WHEN ID_TYPE = 'ZMDBID' THEN IDNUMBER ELSE NULL END) MDB_ID,
                MAX(CASE WHEN ID_TYPE = 'ZHHID' AND TYPE = 1 THEN IDNUMBER ELSE NULL END) CLN_HH_ID
        FROM "+context.NTZ_STG_CRM+"..BUT0ID 
        GROUP BY PARTNER) X
        LEFT OUTER JOIN "+context.NTZ_STG_CRM+"..BUT0ID Y ON X.CLN_HH_ID = Y.IDNUMBER 
        AND Y.ID_TYPE = 'ZHHID' 
        AND Y.TYPE = 3)
		
	
SELECT 
      		CASE WHEN LENGTH(PARTNER_REF.POS_CUST_ID) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(PARTNER_REF.POS_CUST_ID, '1234567890', '')), 0) = 0 THEN SUBSTR(PARTNER_REF.POS_CUST_ID,1,18) ELSE NULL END POS_CUST_ID,
			CASE WHEN LENGTH(PARTNER_REF.ECOMM_CUST_ID) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(PARTNER_REF.ECOMM_CUST_ID, '1234567890', '')), 0) = 0 THEN SUBSTR(PARTNER_REF.ECOMM_CUST_ID,1,18) ELSE NULL END ECOMM_CUST_ID,
			CASE WHEN LENGTH(but000.PARTNER) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.PARTNER, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.PARTNER,1,18) ELSE NULL END SAP_BP_ID,
			CASE WHEN LENGTH(but000.ZZEMPLOYEEID) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZEMPLOYEEID, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZEMPLOYEEID,1,18) ELSE NULL END EMPL_ID,
			CASE WHEN LENGTH(PARTNER_REF.HH_ID) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(PARTNER_REF.HH_ID, '1234567890', '')), 0) = 0 THEN SUBSTR(PARTNER_REF.HH_ID,1,18) ELSE NULL END HH_ID,
			CASE WHEN LENGTH(TRIM(SUBSTR(PARTNER_REF.CL_CUST_ID,1,32))) = 0 THEN NULL ELSE PARTNER_REF.CL_CUST_ID END CL_CUST_ID	,
			CASE WHEN LENGTH(PARTNER_REF.MDB_ID) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(PARTNER_REF.MDB_ID, '1234567890', '')), 0) = 0 THEN SUBSTR(PARTNER_REF.MDB_ID,1,18) ELSE NULL END MDB_ID,
			CASE WHEN LENGTH(TRIM(but000.TYPE)) = 0 THEN NULL ELSE but000.TYPE END CUST_CAT_CODE	,
			CASE WHEN LENGTH(TRIM(but000.BPKIND)) = 0 THEN NULL ELSE but000.BPKIND END CUST_TYPE_CODE	,
			CASE WHEN LENGTH(TRIM(but000.BPEXT)) = 0 THEN NULL ELSE but000.BPEXT END CUST_EXTERNAL_ID	,
			CASE WHEN LENGTH(TRIM(but000.SOURCE)) = 0 THEN NULL ELSE but000.SOURCE END CUST_SRC_CODE	,
			CASE WHEN LENGTH(TRIM( but000.TITLE)) = 0 THEN NULL ELSE but000.TITLE END CUST_TITLE,
		CASE WHEN LENGTH(TRIM(    but000.XDELE)) = 0 THEN NULL ELSE    but000.XDELE END CUST_DELETE_FLAG,
		CASE WHEN LENGTH(TRIM(    but000.XBLCK)) = 0 THEN NULL ELSE    but000.XBLCK END CUST_BLOCK,
		CASE WHEN LENGTH(TRIM(    but000.CONTACT)) = 0 THEN NULL ELSE    but000.CONTACT END CUST_CONTACT_IND,
			but000.ZZEMPHIREDATE	CUST_EMPL_HIRE_DATE,
			but000.ZZEMPTERMDATE	CUST_EMPL_TERMINATION_DATE,
		CASE WHEN LENGTH(TRIM( but000.ZZEMPACTIVE)) = 0 THEN NULL ELSE but000.ZZEMPACTIVE END CUST_EMPL_ACTV_FLAG,
		CASE WHEN LENGTH(TRIM(    but000.ZZEMPSTORE)) = 0 THEN NULL ELSE    but000.ZZEMPSTORE END CUST_EMPL_STORE,
			but000.ZZEMPEFFDATE	CUST_EMPL_EFF_DATE,
			but000.ZZHOMEADDRACQDT		CUST_HOME_ADDR_SRC_DATE	,
			CASE WHEN LENGTH(TRIM(but000.ZZCARRIERROUTE)) = 0 THEN NULL ELSE but000.ZZCARRIERROUTE END CUST_CARRIER_ROUTE,
		CASE WHEN LENGTH(TRIM(    but000.ZZDBPC)) = 0 THEN NULL ELSE    but000.ZZDBPC END CUST_DBPC,
		CASE WHEN LENGTH(TRIM(    but000.ZZRETURNED)) = 0 THEN NULL ELSE    but000.ZZRETURNED END CUST_RETURNED,
		CASE WHEN LENGTH(TRIM(    but000.ZZPENETRATION)) = 0 THEN NULL ELSE    but000.ZZPENETRATION END CUST_PENETRATION_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZPENETRATIONCAT)) = 0 THEN NULL ELSE    but000.ZZPENETRATIONCAT END CUST_PENETRATION_CAT,
		CASE WHEN LENGTH(TRIM(    but000.ZZDECEASED)) = 0 THEN NULL ELSE    but000.ZZDECEASED END CUST_DECEASED_IND,
			but000.ZZFIRSTPURCHDT	CUST_TSC_FIRST_PURCH_DATE,
			CASE WHEN LENGTH(but000.ZZFIRSTPURCHDAYS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURCHDAYS, '1234567890', '')), 0) = 0 THEN but000.ZZFIRSTPURCHDAYS ELSE NULL END CUST_TSC_FIRST_PURCH_DAYS,
			CASE WHEN LENGTH(but000.ZZFIRSTPURTRANS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURTRANS, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZFIRSTPURTRANS,1,18) ELSE NULL END CUST_TSC_FIRST_PURCH_TRANS_NO,
			CASE WHEN LENGTH(but000.ZZFIRSTPURSTORE) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURSTORE, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZFIRSTPURSTORE,1,18) ELSE NULL END CUST_TSC_FIRST_PURCH_STORE_NO,
			CASE WHEN LENGTH(but000.ZZFIRSTPURAMT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURAMT, '-0.123456789', '')), 0) = 0 THEN but000.ZZFIRSTPURAMT ELSE NULL END CUST_TSC_FIRST_PURCH_AMT,
			but000.ZZLASTPURCHDT	CUST_TSC_LAST_PURCH_DATE,
			CASE WHEN LENGTH(but000.ZZLASTPURDAYS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURDAYS, '1234567890', '')), 0) = 0 THEN but000.ZZLASTPURDAYS ELSE NULL END CUST_TSC_LAST_PURCH_DAYS,
			CASE WHEN LENGTH(but000.ZZLASTPURTRANS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURTRANS, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLASTPURTRANS,1,18) ELSE NULL END CUST_TSC_LAST_PURCH_TRANS_NO,
			CASE WHEN LENGTH(but000.ZZLASTPURSTORE) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURSTORE, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLASTPURSTORE,1,18) ELSE NULL END CUST_TSC_LAST_PURCH_STORE_NO,
			CASE WHEN LENGTH(but000.ZZLASTPURAMT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURAMT, '-0.123456789', '')), 0) = 0 THEN but000.ZZLASTPURAMT ELSE NULL END CUST_TSC_LAST_PURCH_AMT,
			CASE WHEN LENGTH(TRIM( but000.ZZHANDRAISER)) = 0 THEN NULL ELSE but000.ZZHANDRAISER END CUST_TSC_HAND_RAISE_IND,
			CASE WHEN LENGTH(but000.ZZFREQSHOPSTORE) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFREQSHOPSTORE, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZFREQSHOPSTORE,1,18) ELSE NULL END CUST_TSC_MAIN_STORE_NO,
			CASE WHEN LENGTH(but000.ZZLIFETIMEPURAMT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLIFETIMEPURAMT, '-0.123456789', '')), 0) = 0 THEN but000.ZZLIFETIMEPURAMT ELSE NULL END CUST_TSC_LIFE_PURCH_AMT,
			CASE WHEN LENGTH(but000.ZZLIFETIMETRANS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLIFETIMETRANS, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLIFETIMETRANS,1,18) ELSE NULL END CUST_TSC_LIFE_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZLTLINEITEMS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLTLINEITEMS, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLTLINEITEMS,1,18) ELSE NULL END CUST_TSC_LIFE_TRANS_LINE_COUNT,
			CASE WHEN LENGTH(but000.ZZRETURNAMT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZRETURNAMT, '-0.123456789', '')), 0) = 0 THEN but000.ZZRETURNAMT ELSE NULL END CUST_TSC_RETURN_AMT,
			CASE WHEN LENGTH(but000.ZZRETURNTRANS) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZRETURNTRANS, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZRETURNTRANS,1,18) ELSE NULL END CUST_TSC_RETURN_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZRETURNLINEIT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZRETURNLINEIT, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZRETURNLINEIT,1,18) ELSE NULL END CUST_TSC_RETURN_TRANS_LINE_COUNT,
			but000.ZZFIRSTPURDTHTP	CUST_HTP_FIRST_PURCH_DATE,
			CASE WHEN LENGTH(but000.ZZFIRSTPURDAYHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURDAYHTP, '1234567890', '')), 0) = 0 THEN but000.ZZFIRSTPURDAYHTP ELSE NULL END CUST_HTP_FIRST_PURCH_DAYS,
			CASE WHEN LENGTH(but000.ZZFIRSTPURSTOHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURSTOHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZFIRSTPURSTOHTP,1,18) ELSE NULL END CUST_HTP_FIRST_PURCH_STORE_NO,
			CASE WHEN LENGTH(but000.ZZFIRSTPURAMTHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFIRSTPURAMTHTP, '-0.123456789', '')), 0) = 0 THEN but000.ZZFIRSTPURAMTHTP ELSE NULL END CUST_HTP_FIRST_PURCH_AMT,
			but000.ZZLASTPURDTHTP	CUST_HTP_LAST_PURCH_DATE,
			CASE WHEN LENGTH(but000.ZZLASTPURDAYHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURDAYHTP, '1234567890', '')), 0) = 0 THEN but000.ZZLASTPURDAYHTP ELSE NULL END CUST_HTP_LAST_PURCH_DAYS,
			CASE WHEN LENGTH(but000.ZZLASTPURSTOHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURSTOHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLASTPURSTOHTP,1,18) ELSE NULL END CUST_HTP_LAST_PURCH_STORE_NO,
			CASE WHEN LENGTH(but000.ZZLASTPURAMTHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLASTPURAMTHTP, '-0.123456789', '')), 0) = 0 THEN but000.ZZLASTPURAMTHTP ELSE NULL END CUST_HTP_LAST_PURCH_AMT,
			CASE WHEN LENGTH(but000.ZZFREQSHOPSTOHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZFREQSHOPSTOHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZFREQSHOPSTOHTP,1,18) ELSE NULL END CUST_HTP_MAIN_STORE_NO,
			CASE WHEN LENGTH(but000.ZZLTPURAMTHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLTPURAMTHTP, '-0.123456789', '')), 0) = 0 THEN but000.ZZLTPURAMTHTP ELSE NULL END CUST_HTP_LIFE_PURCH_AMT,
			CASE WHEN LENGTH(but000.ZZLTTRANSHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLTTRANSHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLTTRANSHTP,1,18) ELSE NULL END CUST_HTP_LIFE_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZLTLINEITEMSHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLTLINEITEMSHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZLTLINEITEMSHTP,1,18) ELSE NULL END CUST_HTP_LIFE_TRANS_LINE_COUNT,
			CASE WHEN LENGTH(but000.ZZRETURNAMTHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZRETURNAMTHTP, '-0.123456789', '')), 0) = 0 THEN but000.ZZRETURNAMTHTP ELSE NULL END CUST_HTP_RETURN_AMT,
			CASE WHEN LENGTH(but000.ZZRETURNTRANSHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZRETURNTRANSHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZRETURNTRANSHTP,1,18) ELSE NULL END CUST_HTP_RETURN_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZRETURNLINEHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZRETURNLINEHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZRETURNLINEHTP,1,18) ELSE NULL END CUST_HTP_RETURN_TRANS_LINE_COUNT,
			CASE WHEN LENGTH(TRIM(  but000.ZZDNCEMAIL)) = 0 THEN NULL ELSE  but000.ZZDNCEMAIL END CUST_DNC_EMAIL_IND,
			but000.ZZDNCEMAILDT	CUST_DNC_EMAIL_DATE,
			CASE WHEN LENGTH(TRIM(    but000.ZZCHILDRENPRES)) = 0 THEN NULL ELSE    but000.ZZCHILDRENPRES END CUST_CHILDREN_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZNAICSCODE)) = 0 THEN NULL ELSE    but000.ZZNAICSCODE END CUST_NAICS_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZNAICSDESC)) = 0 THEN NULL ELSE    but000.ZZNAICSDESC END CUST_NAICS_DESC,
		CASE WHEN LENGTH(TRIM(    but000.ZZHHLDFREQ)) = 0 THEN NULL ELSE    but000.ZZHHLDFREQ END HH_FREQ,
			but000.ZZHHLDFSTPURDT	HH_FIRST_PURCH_DATE,
			but000.ZZHHLDLSTPURDT	HH_LAST_PURCH_DATE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL1H2012)) = 0 THEN NULL ELSE    but000.ZZCTRL1H2012 END HH_CONTROL_GROUP_2012H1,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL2H2012)) = 0 THEN NULL ELSE    but000.ZZCTRL2H2012 END HH_CONTROL_GROUP_2012H2,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL1H2013)) = 0 THEN NULL ELSE    but000.ZZCTRL1H2013 END HH_CONTROL_GROUP_2013H1,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL2H2013)) = 0 THEN NULL ELSE    but000.ZZCTRL2H2013 END HH_CONTROL_GROUP_2013H2,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL2H2014)) = 0 THEN NULL ELSE    but000.ZZCTRL2H2014 END HH_CONTROL_GROUP_2014H2,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL2H2015)) = 0 THEN NULL ELSE    but000.ZZCTRL2H2015 END HH_CONTROL_GROUP_2015H2,
		CASE WHEN LENGTH(TRIM(    but000.ZZCTRL1H2016)) = 0 THEN NULL ELSE    but000.ZZCTRL1H2016 END HH_CONTROL_GROUP_2016H1,
			CASE WHEN LENGTH(but000.ZZCLOSESTSTORECO) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCLOSESTSTORECO, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZCLOSESTSTORECO,1,18) ELSE NULL END CUST_TSC_CLOSEST_STORE_NO,
			CASE WHEN LENGTH(but000.ZZNUMTRANS365) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZNUMTRANS365, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZNUMTRANS365,1,18) ELSE NULL END CUST_TSC_1_365_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZNUMTRANS180) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZNUMTRANS180, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZNUMTRANS180,1,18) ELSE NULL END CUST_TSC_1_180_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRANS181_365) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRANS181_365, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRANS181_365,1,18) ELSE NULL END CUST_TSC_181_365_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRANS366_546) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRANS366_546, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRANS366_546,1,18) ELSE NULL END CUST_TSC_366_546_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRANS366_730) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRANS366_730, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRANS366_730,1,18) ELSE NULL END CUST_TSC_366_730_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZSPENDLST365D) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZSPENDLST365D, '-0.123456789', '')), 0) = 0 THEN but000.ZZSPENDLST365D ELSE NULL END CUST_TSC_1_365_SALES_AMT,
			CASE WHEN LENGTH(but000.ZZCLOSESTSTHTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCLOSESTSTHTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZCLOSESTSTHTP,1,18) ELSE NULL END CUST_HTP_CLOSEST_STORE_NO,
			CASE WHEN LENGTH(but000.ZZTRANS365HTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRANS365HTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRANS365HTP,1,18) ELSE NULL END CUST_HTP_1_365_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRANS180HTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRANS180HTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRANS180HTP,1,18) ELSE NULL END CUST_HTP_1_180_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRAN181_365HTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRAN181_365HTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRAN181_365HTP,1,18) ELSE NULL END CUST_HTP_181_365_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRAN366_546HTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRAN366_546HTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRAN366_546HTP,1,18) ELSE NULL END CUST_HTP_366_546_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZTRAN366_730HTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTRAN366_730HTP, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ZZTRAN366_730HTP,1,18) ELSE NULL END CUST_HTP_366_730_TRANS_COUNT,
			CASE WHEN LENGTH(but000.ZZSPEND365HTP) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZSPEND365HTP, '-0.123456789', '')), 0) = 0 THEN but000.ZZSPEND365HTP ELSE NULL END CUST_HTP_1_365_SALES_AMT,
		CASE WHEN LENGTH(TRIM(    but000.ZZLOYALTYFF)) = 0 THEN NULL ELSE    but000.ZZLOYALTYFF END CUST_FF_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLOYALTYNC)) = 0 THEN NULL ELSE    but000.ZZLOYALTYNC END CUST_NC_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCONSUMERCD)) = 0 THEN NULL ELSE    but000.ZZCONSUMERCD END CUST_CONSUMER_CARD_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZBUSINESSCARD)) = 0 THEN NULL ELSE    but000.ZZBUSINESSCARD END CUST_BUS_CARD_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLEGHHLDID)) = 0 THEN NULL ELSE    but000.ZZLEGHHLDID END CUST_LEGACY_HH_ID,
		CASE WHEN LENGTH(TRIM(    but000.ZZFIRSTACQNAME)) = 0 THEN NULL ELSE    but000.ZZFIRSTACQNAME END CUST_FIRST_SRC_NAME,
		CASE WHEN LENGTH(TRIM(    but000.ZZACTBANKCARDH)) = 0 THEN NULL ELSE    but000.ZZACTBANKCARDH END HH_ACTV_BANK_CARD_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZACTBANKCARDI)) = 0 THEN NULL ELSE    but000.ZZACTBANKCARDI END CUST_ACTV_BANK_CARD_IND,
			CASE WHEN LENGTH(but000.ZZADULTCOUNT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZADULTCOUNT, '1234567890', '')), 0) = 0 THEN but000.ZZADULTCOUNT ELSE NULL END HH_ADULT_COUNT,
			CASE WHEN LENGTH(but000.ZZADULTCOUNTF) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZADULTCOUNTF, '1234567890', '')), 0) = 0 THEN but000.ZZADULTCOUNTF ELSE NULL END HH_ADULT_FEMALE_COUNT,
			CASE WHEN LENGTH(but000.ZZADULTCOUNTM) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZADULTCOUNTM, '1234567890', '')), 0) = 0 THEN but000.ZZADULTCOUNTM ELSE NULL END HH_ADULT_MALE_COUNT,
			CASE WHEN LENGTH(but000.ZZCHILDHHCOUNT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCHILDHHCOUNT, '1234567890', '')), 0) = 0 THEN but000.ZZCHILDHHCOUNT ELSE NULL END HH_CHILD_COUNT,
			CASE WHEN LENGTH(but000.ZZAGEOFHHMBR) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZAGEOFHHMBR, '1234567890', '')), 0) = 0 THEN but000.ZZAGEOFHHMBR ELSE NULL END CUST_AGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZBANKCARDHOLDER)) = 0 THEN NULL ELSE    but000.ZZBANKCARDHOLDER END CUST_BANK_CARD_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCAMPINGINT)) = 0 THEN NULL ELSE    but000.ZZCAMPINGINT END CUST_CAMPING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCARBUFF)) = 0 THEN NULL ELSE    but000.ZZCARBUFF END CUST_CAR_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCATOWNER)) = 0 THEN NULL ELSE    but000.ZZCATOWNER END CUST_CAT_OWNER_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCREDITCARDRETL)) = 0 THEN NULL ELSE    but000.ZZCREDITCARDRETL END CUST_RETAIL_CREDIT_CARD_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZDMACODES)) = 0 THEN NULL ELSE    but000.ZZDMACODES END CUST_DMA_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZDMAAREA)) = 0 THEN NULL ELSE    but000.ZZDMAAREA END CUST_DMA_AREA,
		CASE WHEN LENGTH(TRIM(    but000.ZZDOGOWNER)) = 0 THEN NULL ELSE    but000.ZZDOGOWNER END CUST_DOG_OWNER_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZEXPINCOMERANK)) = 0 THEN NULL ELSE    but000.ZZEXPINCOMERANK END CUST_INCOME_RANK,
		CASE WHEN LENGTH(TRIM(    but000.ZZFAMILYID)) = 0 THEN NULL ELSE    but000.ZZFAMILYID END CUST_FAMILY_ID,
		CASE WHEN LENGTH(TRIM(    but000.ZZFISHINGINT)) = 0 THEN NULL ELSE    but000.ZZFISHINGINT END CUST_FISHING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZGARDHORTINT)) = 0 THEN NULL ELSE    but000.ZZGARDHORTINT END CUST_GARDEN_IND,
			CASE WHEN LENGTH(but000.ZZINCOMEHHEST) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZINCOMEHHEST, '1234567890', '')), 0) = 0 THEN but000.ZZINCOMEHHEST ELSE NULL END HH_INCOME_ESTIMATE,
		CASE WHEN LENGTH(TRIM( but000.ZZIFAMINCDETCD)) = 0 THEN NULL ELSE but000.ZZIFAMINCDETCD END HH_FAMILY_INCOME_DET_CD,
		CASE WHEN LENGTH(TRIM(    but000.ZZFAMINCDETRG)) = 0 THEN NULL ELSE    but000.ZZFAMINCDETRG END HH_FAMILY_INCOME_DET_RG,
		CASE WHEN LENGTH(TRIM( but000.ZZINDIDNUMBER)) = 0 THEN NULL ELSE but000.ZZINDIDNUMBER END CUST_INDV_ID,
		CASE WHEN LENGTH(TRIM(    but000.ZZGENDERCODE)) = 0 THEN NULL ELSE    but000.ZZGENDERCODE END CUST_GENDER_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZHEADOFHH)) = 0 THEN NULL ELSE    but000.ZZHEADOFHH END CUST_HEAD_OF_HH_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZHEATINGTYP)) = 0 THEN NULL ELSE    but000.ZZHEATINGTYP END CUST_HEATING_TYPE,
		CASE WHEN LENGTH(TRIM(    but000.ZZHOMEOWNER)) = 0 THEN NULL ELSE    but000.ZZHOMEOWNER END CUST_HOME_OWNER_FLAG,
		CASE WHEN LENGTH(TRIM(    but000.ZZHUNTING)) = 0 THEN NULL ELSE    but000.ZZHUNTING END CUST_HUNTING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLGTHOFRES)) = 0 THEN NULL ELSE    but000.ZZLGTHOFRES END CUST_LENGTH_OF_RESIDENCE,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIAPPAREL)) = 0 THEN NULL ELSE    but000.ZZLHIAPPAREL END CUST_LHI_APPAREL_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIAPPMEN)) = 0 THEN NULL ELSE    but000.ZZLHIAPPMEN END CUST_LHI_APPAREL_MEN_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIAPPWOM)) = 0 THEN NULL ELSE    but000.ZZLHIAPPWOM END CUST_LHI_APPAREL_WOMEN_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIAUTO)) = 0 THEN NULL ELSE    but000.ZZLHIAUTO END CUST_LHI_AUTO_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIAUTORAC)) = 0 THEN NULL ELSE    but000.ZZLHIAUTORAC END CUST_LHI_AUTO_RACING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIAUTOTR)) = 0 THEN NULL ELSE    but000.ZZLHIAUTOTR END CUST_LHI_TRUCKS_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIBIRDS)) = 0 THEN NULL ELSE    but000.ZZLHIBIRDS END CUST_LHI_BIRDS_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIDIY)) = 0 THEN NULL ELSE    but000.ZZLHIDIY END CUST_LHI_DIY_IND,
		CASE WHEN LENGTH(TRIM(but000.ZZLHIDONOR)) = 0 THEN NULL ELSE but000.ZZLHIDONOR END CUST_LHI_DONOR_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIEQUESTR)) = 0 THEN NULL ELSE    but000.ZZLHIEQUESTR END CUST_LHI_EQUESTRIAN_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIGARDEN)) = 0 THEN NULL ELSE    but000.ZZLHIGARDEN END CUST_LHI_GARDENING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIWWWBUY)) = 0 THEN NULL ELSE    but000.ZZLHIWWWBUY END CUST_LHI_INTERNET_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIOUTCMP)) = 0 THEN NULL ELSE    but000.ZZLHIOUTCMP END CUST_LHI_CAMPING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIOUTFSH)) = 0 THEN NULL ELSE    but000.ZZLHIOUTFSH END CUST_LHI_FISHING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIOUTHUN)) = 0 THEN NULL ELSE    but000.ZZLHIOUTHUN END CUST_LHI_HUNTING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIPETS)) = 0 THEN NULL ELSE    but000.ZZLHIPETS END CUST_LHI_PETS_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIPETCATS)) = 0 THEN NULL ELSE    but000.ZZLHIPETCATS END CUST_LHI_CATS_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIPETDOGS)) = 0 THEN NULL ELSE    but000.ZZLHIPETDOGS END CUST_LHI_DOGS_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZLHIRURAL)) = 0 THEN NULL ELSE    but000.ZZLHIRURAL END CUST_LHI_RURAL_IND,
		CASE WHEN LENGTH(TRIM(but000.ZZLHIOUTDOORS)) = 0 THEN NULL ELSE but000.ZZLHIOUTDOORS END CUST_LHI_OUTDOOR_IND,
			CASE WHEN LENGTH(but000.ZZLOTSIZE) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZLOTSIZE, '1234567890', '')), 0) = 0 THEN but000.ZZLOTSIZE ELSE NULL END CUST_LOT_SIZE,
			CASE WHEN LENGTH(TRIM( but000.ZZMAILRESP)) = 0 THEN NULL ELSE but000.ZZMAILRESP END CUST_PREVIOUS_MAIL_RESPONSE_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZMARITALSTI)) = 0 THEN NULL ELSE    but000.ZZMARITALSTI END CUST_MARITAL_STATUS_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTTG017)) = 0 THEN NULL ELSE    but000.ZZMKTTG017 END CUST_0_17_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG1824F)) = 0 THEN NULL ELSE    but000.ZZMKTG1824F END CUST_18_24F_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG1824M)) = 0 THEN NULL ELSE    but000.ZZMKTG1824M END CUST_18_24M_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG2534F)) = 0 THEN NULL ELSE    but000.ZZMKTG2534F END CUST_25_34F_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG2534M)) = 0 THEN NULL ELSE    but000.ZZMKTG2534M END CUST_25_34M_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG4554F)) = 0 THEN NULL ELSE    but000.ZZMKTG4554F END CUST_45_54F_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG4554M)) = 0 THEN NULL ELSE    but000.ZZMKTG4554M END CUST_45_54M_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG5564F)) = 0 THEN NULL ELSE    but000.ZZMKTG5564F END CUST_55_64F_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG5564M)) = 0 THEN NULL ELSE    but000.ZZMKTG5564M END CUST_55_64M_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTG65PL)) = 0 THEN NULL ELSE    but000.ZZMKTG65PL END CUST_65_UP_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTGHH12)) = 0 THEN NULL ELSE    but000.ZZMKTGHH12 END HH_1_2_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZMKTGHH3P)) = 0 THEN NULL ELSE    but000.ZZMKTGHH3P END HH_3_UP_MKT,
		CASE WHEN LENGTH(TRIM(    but000.ZZOUTDOORENT)) = 0 THEN NULL ELSE    but000.ZZOUTDOORENT END CUST_OUTDOOR_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZOGHINTENT)) = 0 THEN NULL ELSE    but000.ZZOGHINTENT END CUST_OUTDOOR_GARDEN_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZPETOWNER)) = 0 THEN NULL ELSE    but000.ZZPETOWNER END CUST_PET_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZPRIZMLG)) = 0 THEN NULL ELSE    but000.ZZPRIZMLG END CUST_PRIZM_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZPROPTYPE)) = 0 THEN NULL ELSE    but000.ZZPROPTYPE END CUST_PROPERTY_TYPE,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRATV)) = 0 THEN NULL ELSE    but000.ZZTGRATV END CUST_TR_ATV_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRACM)) = 0 THEN NULL ELSE    but000.ZZTGRACM END CUST_TR_ACM_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRCATPR)) = 0 THEN NULL ELSE    but000.ZZTGRCATPR END CUST_TR_CAT_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRCREDRW)) = 0 THEN NULL ELSE    but000.ZZTGRCREDRW END CUST_TR_CCRW_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRDOGPR)) = 0 THEN NULL ELSE    but000.ZZTGRDOGPR END CUST_TR_DOG_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRGARDEN)) = 0 THEN NULL ELSE    but000.ZZTGRGARDEN END CUST_TR_GARDEN_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRHCOUPON)) = 0 THEN NULL ELSE    but000.ZZTGRHCOUPON END CUST_TR_COUPON_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRHUNTING)) = 0 THEN NULL ELSE    but000.ZZTGRHUNTING END CUST_TR_HUNTING_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRMOBINT)) = 0 THEN NULL ELSE    but000.ZZTGRMOBINT END CUST_TR_MOBILE_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRNASCAR)) = 0 THEN NULL ELSE    but000.ZZTGRNASCAR END CUST_TR_NASCAR_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRONLINEB)) = 0 THEN NULL ELSE    but000.ZZTGRONLINEB END CUST_TR_ONLINE_B_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRONLINEP)) = 0 THEN NULL ELSE    but000.ZZTGRONLINEP END CUST_TR_ONLINE_P_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTGRSOCIAL)) = 0 THEN NULL ELSE    but000.ZZTGRSOCIAL END CUST_TR_SOCIAL_IND,
		CASE WHEN LENGTH(but000.ZZCE2010STCD) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCE2010STCD, '1234567890', '')), 0) = 0 THEN but000.ZZCE2010STCD ELSE NULL END CUST_2010_STATE_CODE,
			CASE WHEN LENGTH(but000.ZZCE2010CNCD) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCE2010CNCD, '1234567890', '')), 0) = 0 THEN but000.ZZCE2010CNCD ELSE NULL END CUST_2010_COUNTY_CODE,
			CASE WHEN LENGTH(TRIM(but000.ZZCCD2010TRCD)) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCCD2010TRCD, '1234567890', '')), 0) = 0 THEN but000.ZZCCD2010TRCD ELSE NULL END CUST_2010_TRACT_CODE,
			CASE WHEN LENGTH(but000.ZZCE2010BGCD) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZCE2010BGCD, '1234567890', '')), 0) = 0 THEN but000.ZZCE2010BGCD ELSE NULL END CUST_2010_BG_CODE,
		CASE WHEN LENGTH(TRIM( but000.ZZCHILDBYAGE)) = 0 THEN NULL ELSE but000.ZZCHILDBYAGE END CUST_CHILDREN_BY_AGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCONSCLUST)) = 0 THEN NULL ELSE    but000.ZZCONSCLUST END CUST_CLUSTER_SPECTRUM,
		CASE WHEN LENGTH(TRIM(    but000.ZZETHGROUPCD)) = 0 THEN NULL ELSE    but000.ZZETHGROUPCD END CUST_ETHNIC_GROUP,
		CASE WHEN LENGTH(TRIM(    but000.ZZETHNICODE)) = 0 THEN NULL ELSE    but000.ZZETHNICODE END CUST_ETHNICITY,
		CASE WHEN LENGTH(TRIM(    but000.ZZSPOKENLGCD)) = 0 THEN NULL ELSE    but000.ZZSPOKENLGCD END CUST_LANGUAGE_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZHOMEVALUE)) = 0 THEN NULL ELSE    but000.ZZHOMEVALUE END CUST_HOME_VALUE_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCUSTCLEANSEDST)) = 0 THEN NULL ELSE    but000.ZZCUSTCLEANSEDST END CUST_TSC_CLEANSE_STATUS,
		CASE WHEN LENGTH(TRIM(    but000.ZZTSCNCWELCOMERT)) = 0 THEN NULL ELSE    but000.ZZTSCNCWELCOMERT END CUST_NC_WELCOME_STRING,
			CASE WHEN LENGTH(but000.ZZTSCNCWELCOMECT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTSCNCWELCOMECT, '1234567890', '')), 0) = 0 THEN but000.ZZTSCNCWELCOMECT ELSE NULL END CUST_NC_WELCOME_COUNT,
		CASE WHEN LENGTH(TRIM(    but000.ZZTSCNCWELCOMEST)) = 0 THEN NULL ELSE    but000.ZZTSCNCWELCOMEST END CUST_NC_WELCOME_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZTSCNCUNENROLRT)) = 0 THEN NULL ELSE    but000.ZZTSCNCUNENROLRT END CUST_NC_UNENROLL_STRING,
			CASE WHEN LENGTH(but000.ZZTSCNCUNENROLCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTSCNCUNENROLCT, '1234567890', '')), 0) = 0 THEN but000.ZZTSCNCUNENROLCT ELSE NULL END CUST_NC_UNENROLL_COUNT,
			CASE WHEN LENGTH(TRIM( but000.ZZTSCNCUNENROLST)) = 0 THEN NULL ELSE but000.ZZTSCNCUNENROLST END CUST_NC_UNENROLL_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZTSCNCUNDOUERRT)) = 0 THEN NULL ELSE    but000.ZZTSCNCUNDOUERRT END CUST_NC_UNDO_UNENROLL_ACTION,
			CASE WHEN LENGTH(but000.ZZTSCNCUNDOUERCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZTSCNCUNDOUERCT, '1234567890', '')), 0) = 0 THEN but000.ZZTSCNCUNDOUERCT ELSE NULL END CUST_NC_UNDO_UNENROLL_COUNT,
		CASE WHEN LENGTH(TRIM( but000.ZZTSCNCUNDOUERST)) = 0 THEN NULL ELSE but000.ZZTSCNCUNDOUERST END CUST_NC_UNDO_UNENROLL_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZHTPFFWELCOMERT)) = 0 THEN NULL ELSE    but000.ZZHTPFFWELCOMERT END CUST_FF_WELCOME_ACTION,
			CASE WHEN LENGTH(but000.ZZHTPFFWELCOMECT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZHTPFFWELCOMECT, '1234567890', '')), 0) = 0 THEN but000.ZZHTPFFWELCOMECT ELSE NULL END CUST_FF_WELCOME_COUNT,
			CASE WHEN LENGTH(TRIM( but000.ZZHTPFFWELCOMEST)) = 0 THEN NULL ELSE but000.ZZHTPFFWELCOMEST END CUST_FF_WELCOME_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZHTPFFUNENROLRT)) = 0 THEN NULL ELSE    but000.ZZHTPFFUNENROLRT END CUST_FF_UNENROLL_STRING,
			CASE WHEN LENGTH(but000.ZZHTPFFUNENROLCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZHTPFFUNENROLCT, '1234567890', '')), 0) = 0 THEN but000.ZZHTPFFUNENROLCT ELSE NULL END CUST_FF_UNENROLL_COUNT,
			CASE WHEN LENGTH(TRIM( but000.ZZHTPFFUNENROLST)) = 0 THEN NULL ELSE but000.ZZHTPFFUNENROLST END CUST_FF_UNENROLL_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZHTPFFUNDOUERRT)) = 0 THEN NULL ELSE    but000.ZZHTPFFUNDOUERRT END CUST_FF_UNDO_UNENROLL_ACTION,
			CASE WHEN LENGTH(but000.ZZHTPFFUNDOUERCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZHTPFFUNDOUERCT, '1234567890', '')), 0) = 0 THEN but000.ZZHTPFFUNDOUERCT ELSE NULL END CUST_FF_UNDO_UNENROLL_COUNT,
		CASE WHEN LENGTH(TRIM(but000.ZZHTPFFUNDOUERST)) = 0 THEN NULL ELSE but000.ZZHTPFFUNDOUERST END CUST_FF_UNDO_UNENROLL_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZWCSMKOPTINRT)) = 0 THEN NULL ELSE    but000.ZZWCSMKOPTINRT END CUST_ECOMM_OPT_IN_ACTION,
			CASE WHEN LENGTH(but000.ZZWCSMKOPTINCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZWCSMKOPTINCT, '1234567890', '')), 0) = 0 THEN but000.ZZWCSMKOPTINCT ELSE NULL END CUST_ECOMM_OPT_IN_COUNT,
			CASE WHEN LENGTH(TRIM(but000.ZZWCSMKOPTINST)) = 0 THEN NULL ELSE but000.ZZWCSMKOPTINST END CUST_ECOMM_OPT_IN_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZWCSMKOPTOUTRT)) = 0 THEN NULL ELSE    but000.ZZWCSMKOPTOUTRT END CUST_ECOMM_OPT_OUT_ACTION,
			CASE WHEN LENGTH(but000.ZZWCSMKOPTOUTCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZWCSMKOPTOUTCT, '1234567890', '')), 0) = 0 THEN but000.ZZWCSMKOPTOUTCT ELSE NULL END CUST_ECOMM_OPT_OUT_COUNT,
		CASE WHEN LENGTH(TRIM(but000.ZZWCSMKOPTOUTST)) = 0 THEN NULL ELSE but000.ZZWCSMKOPTOUTST END CUST_ECOMM_OPT_OUT_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM(    but000.ZZWCSMKUNOPOUTRT)) = 0 THEN NULL ELSE    but000.ZZWCSMKUNOPOUTRT END CUST_ECOMM_UNDO_OPT_OUT_ACTION,
			CASE WHEN LENGTH(but000.ZZWCSMKUNOPOUTCT) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZWCSMKUNOPOUTCT, '1234567890', '')), 0) = 0 THEN but000.ZZWCSMKUNOPOUTCT ELSE NULL END CUST_ECOMM_UNDO_OPT_OUT_COUNT,
		CASE WHEN LENGTH(TRIM( but000.ZZWCSMKUNOPOUTST)) = 0 THEN NULL ELSE but000.ZZWCSMKUNOPOUTST END CUST_ECOMM_UNDO_OPT_OUT_ACTION_RANGE,
		CASE WHEN LENGTH(TRIM( but000.ZZTAXEXEMPT)) = 0 THEN NULL ELSE but000.ZZTAXEXEMPT END CUST_TAX_EXEMPT_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZMOSAIC)) = 0 THEN NULL ELSE    but000.ZZMOSAIC END CUST_MOSAIC_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZMOSAICDESC)) = 0 THEN NULL ELSE    but000.ZZMOSAICDESC END CUST_MOSAIC_DESC,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONADDRS)) = 0 THEN NULL ELSE    but000.ZZCLNREASONADDRS END CUST_CL_RESN_ADDR_STD,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONNAMES)) = 0 THEN NULL ELSE    but000.ZZCLNREASONNAMES END CUST_CL_RESN_NAME_STD,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONNCOA)) = 0 THEN NULL ELSE    but000.ZZCLNREASONNCOA END CUST_CL_RESN_NCOA,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONGEOA)) = 0 THEN NULL ELSE    but000.ZZCLNREASONGEOA END CUST_CL_RESN_LOC_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONZIPA)) = 0 THEN NULL ELSE    but000.ZZCLNREASONZIPA END CUST_CL_RESN_ZIP_CODE_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONPHONS)) = 0 THEN NULL ELSE    but000.ZZCLNREASONPHONS END CUST_CL_RESN_PHONE_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONEMAIL)) = 0 THEN NULL ELSE    but000.ZZCLNREASONEMAIL END CUST_CL_RESN_EMAIL_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONTELES)) = 0 THEN NULL ELSE    but000.ZZCLNREASONTELES END CUST_CL_RESN_PHONE_STD,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONEMS)) = 0 THEN NULL ELSE    but000.ZZCLNREASONEMS END CUST_CL_RESN_EMAIL_STD,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNRESONSUPPA)) = 0 THEN NULL ELSE    but000.ZZCLNRESONSUPPA END CUST_CL_RESN_SUPPRESS_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONMOSA)) = 0 THEN NULL ELSE    but000.ZZCLNREASONMOSA END CUST_CL_RESN_MOSAIC_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONBUSA)) = 0 THEN NULL ELSE    but000.ZZCLNREASONBUSA END CUST_CL_RESN_BUS_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNREASONCONSA)) = 0 THEN NULL ELSE    but000.ZZCLNREASONCONSA END CUST_CL_RESN_CONSUMER_APPEND,
		CASE WHEN LENGTH(TRIM(    but000.ZZDNUNAME)) = 0 THEN NULL ELSE    but000.ZZDNUNAME END CUST_DO_NOT_UPD_NAME,
		CASE WHEN LENGTH(TRIM(    but000.ZZDNUHH)) = 0 THEN NULL ELSE    but000.ZZDNUHH END CUST_DO_NOT_UPD_HH,
		CASE WHEN LENGTH(TRIM(    but000.ZZDNUADDRESS)) = 0 THEN NULL ELSE    but000.ZZDNUADDRESS END CUST_DO_NOT_UPD_ADDR,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNVULGARFLAG)) = 0 THEN NULL ELSE    but000.ZZCLNVULGARFLAG END CUST_CL_VULGAR_FLAG,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNVACANT)) = 0 THEN NULL ELSE    but000.ZZCLNVACANT END CUST_CL_VACANT,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNSUPPTP)) = 0 THEN NULL ELSE    but000.ZZCLNSUPPTP END CUST_CL_TRAILER_PARK,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNSUPPPRISON)) = 0 THEN NULL ELSE    but000.ZZCLNSUPPPRISON END CUST_CL_PRISON,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNSUPPNHOME)) = 0 THEN NULL ELSE    but000.ZZCLNSUPPNHOME END CUST_CL_NURSING,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNSUPPMILITAR)) = 0 THEN NULL ELSE    but000.ZZCLNSUPPMILITAR END CUST_CL_MILITARY,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNDNCWORK)) = 0 THEN NULL ELSE    but000.ZZCLNDNCWORK END CUST_DNC_WORK,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNDNCHOME)) = 0 THEN NULL ELSE    but000.ZZCLNDNCHOME END CUST_DNC_HOME,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNDNCCELL)) = 0 THEN NULL ELSE    but000.ZZCLNDNCCELL END CUST_DNC_MOBILE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNDNCOTH)) = 0 THEN NULL ELSE    but000.ZZCLNDNCOTH END CUST_DNC_OTHER,
		CASE WHEN LENGTH(TRIM(    but000.ZZDNCMAIL)) = 0 THEN NULL ELSE    but000.ZZDNCMAIL END CUST_DNC_MAIL,
			but000.ZZDNCMAILDATE	CUST_DNC_MAIL_DATE,
		CASE WHEN LENGTH(TRIM(    but000.ZZREQTYPE)) = 0 THEN NULL ELSE    but000.ZZREQTYPE END CUST_REQUEST_TYPE,
		CASE WHEN LENGTH(TRIM(    but000.ZZSUITELINKMATCH)) = 0 THEN NULL ELSE    but000.ZZSUITELINKMATCH END CUST_SUITE_LINK_MATCH,
		CASE WHEN LENGTH(TRIM(    but000.ZZRESADDRDEL)) = 0 THEN NULL ELSE    but000.ZZRESADDRDEL END CUST_RESIDENCE_DELIV,
		CASE WHEN LENGTH(TRIM(    but000.ZZSICLIST)) = 0 THEN NULL ELSE    but000.ZZSICLIST END CUST_SIC_LIST,
		CASE WHEN LENGTH(TRIM(    but000.ZZSICCODE)) = 0 THEN NULL ELSE    but000.ZZSICCODE END CUST_SIC_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZBUSINESSTYPE)) = 0 THEN NULL ELSE    but000.ZZBUSINESSTYPE END CUST_BUS_TYPE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNLACSLINKIND)) = 0 THEN NULL ELSE    but000.ZZCLNLACSLINKIND END CUST_LACSLINK_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNLACSLINKCD)) = 0 THEN NULL ELSE    but000.ZZCLNLACSLINKCD END CUST_LACSLINK_CODE,
			but000.ZZNCOAMOVEDATE	CUST_NCOA_MOVE_DATE,
			CASE WHEN LENGTH(TRIM(    but000.ZZCLNDBPC)) = 0 THEN NULL ELSE    but000.ZZCLNDBPC END CUST_CL_DELIV_POINT,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNDPVCODE)) = 0 THEN NULL ELSE    but000.ZZCLNDPVCODE END CUST_CL_DPV_MATCH_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCLNDPVNOTES)) = 0 THEN NULL ELSE    but000.ZZCLNDPVNOTES END CUST_CL_DPV_NOTE,
		CASE WHEN LENGTH(TRIM(    but000.ZZDPVRECTYPE)) = 0 THEN NULL ELSE    but000.ZZDPVRECTYPE END CUST_CL_DPV_RECORD_TYPE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCMRA)) = 0 THEN NULL ELSE    but000.ZZCMRA END CUST_CL_CMRA,
		CASE WHEN LENGTH(TRIM(    but000.ZZLOCATION)) = 0 THEN NULL ELSE    but000.ZZLOCATION END CUST_BUS_LOC,
		CASE WHEN LENGTH(TRIM(    but000.ZZLOCSALESVOL)) = 0 THEN NULL ELSE    but000.ZZLOCSALESVOL END CUST_BUS_SALES,
		CASE WHEN LENGTH(TRIM(    but000.ZZLOCEMPLSIZE)) = 0 THEN NULL ELSE    but000.ZZLOCEMPLSIZE END CUST_BUS_SIZE,
		CASE WHEN LENGTH(TRIM(    but000.ZZCORPSALESVOL)) = 0 THEN NULL ELSE    but000.ZZCORPSALESVOL END CUST_CO_SALES,
		CASE WHEN LENGTH(TRIM(    but000.ZZCORPEMPLSIZE)) = 0 THEN NULL ELSE    but000.ZZCORPEMPLSIZE END CUST_CO_SIZE,
		CASE WHEN LENGTH(TRIM(    but000.ZZMOSAICZIP4)) = 0 THEN NULL ELSE    but000.ZZMOSAICZIP4 END CUST_MOSAIC_4_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZMOSAICZIP4DESC)) = 0 THEN NULL ELSE    but000.ZZMOSAICZIP4DESC END CUST_MOSAIC_4_DESC,
		CASE WHEN LENGTH(TRIM(    but000.ZZDISTCHANNELCD)) = 0 THEN NULL ELSE    but000.ZZDISTCHANNELCD END CUST_DISTB_CHAN,
		CASE WHEN LENGTH(TRIM(    but000.ZZREGDIVISION)) = 0 THEN NULL ELSE    but000.ZZREGDIVISION END CUST_REGION_DIV,
		CASE WHEN LENGTH(TRIM(    but000.ZZREGNUMBER)) = 0 THEN NULL ELSE    but000.ZZREGNUMBER END CUST_REGION_NO,
		CASE WHEN LENGTH(TRIM(    but000.ZZDISTNUMBER)) = 0 THEN NULL ELSE    but000.ZZDISTNUMBER END CUST_DIST_NO,
		CASE WHEN LENGTH(TRIM(    but000.ZZCOMPSTORE)) = 0 THEN NULL ELSE    but000.ZZCOMPSTORE END CUST_COMP_STORE,
		CASE WHEN LENGTH(TRIM(    but000.ZZSTORESQFT)) = 0 THEN NULL ELSE    but000.ZZSTORESQFT END CUST_STORE_SQUARE_FEET,
		CASE WHEN LENGTH(TRIM(    but000.ZZDISTRICTNAME)) = 0 THEN NULL ELSE    but000.ZZDISTRICTNAME END CUST_DIST_NAME,
		CASE WHEN LENGTH(TRIM(    but000.ZZLAYOUTTYPE)) = 0 THEN NULL ELSE    but000.ZZLAYOUTTYPE END CUST_STORE_LAYOUT,
		CASE WHEN LENGTH(TRIM(    but000.ZZTITLECODE)) = 0 THEN NULL ELSE    but000.ZZTITLECODE END CUST_TITLE_CODE,
		CASE WHEN LENGTH(TRIM(    but000.ZZTITLECODEDESC)) = 0 THEN NULL ELSE    but000.ZZTITLECODEDESC END CUST_TITLE_DESC,
		CASE WHEN LENGTH(TRIM(    but000.ZZEVENTID)) = 0 THEN NULL ELSE    but000.ZZEVENTID END CUST_EVENT_ID,
		CASE WHEN LENGTH(TRIM(    but000.ZZEVENTTYPE)) = 0 THEN NULL ELSE    but000.ZZEVENTTYPE END CUST_EVENT_TYPE,
			but000.ZZEVENTDATE	CUST_EVENT_DATE,
		CASE WHEN LENGTH(TRIM(    but000.ZZDMOPTIN)) = 0 THEN NULL ELSE    but000.ZZDMOPTIN END CUST_DIRECT_MAIL_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZEMOPTIN)) = 0 THEN NULL ELSE    but000.ZZEMOPTIN END CUST_EMAIL_IND,
		CASE WHEN LENGTH(TRIM(    but000.ZZTRANSACTION)) = 0 THEN NULL ELSE    but000.ZZTRANSACTION END CUST_TRANS_NO,
			CASE WHEN LENGTH(but000.ZZPRICEZONE) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ZZPRICEZONE, '1234567890', '')), 0) = 0 THEN but000.ZZPRICEZONE ELSE NULL END CUST_PRICE_ZONE,
			CASE WHEN LENGTH(TRIM( but000.ZZTSCSUPPRESS)) = 0 THEN NULL ELSE but000.ZZTSCSUPPRESS END CUST_TSC_SUPPRESS_FLAG,
		CASE WHEN LENGTH(TRIM(    but000.ZZEMAILVALIDFLAG)) = 0 THEN NULL ELSE    but000.ZZEMAILVALIDFLAG END CUST_EMAIL_VALID_FLAG,
		CASE WHEN LENGTH(TRIM(    but000.NAME_ORG1)) = 0 THEN NULL ELSE    but000.NAME_ORG1 END CUST_ORG_NAME_1,
		CASE WHEN LENGTH(TRIM(    but000.NAME_ORG2)) = 0 THEN NULL ELSE    but000.NAME_ORG2 END CUST_ORG_NAME_2,
		CASE WHEN LENGTH(TRIM(    but000.NAME_ORG3)) = 0 THEN NULL ELSE    but000.NAME_ORG3 END CUST_ORG_NAME_3,
		CASE WHEN LENGTH(TRIM(    but000.NAME_ORG4)) = 0 THEN NULL ELSE    but000.NAME_ORG4 END CUST_ORG_NAME_4,
		CASE WHEN LENGTH(TRIM(    but000.LEGAL_ENTY)) = 0 THEN NULL ELSE    but000.LEGAL_ENTY END CUST_ORG_FORM,
		CASE WHEN LENGTH(TRIM(    but000.IND_SECTOR)) = 0 THEN NULL ELSE    but000.IND_SECTOR END CUST_INDUSTRY_SECTOR,
		CASE WHEN LENGTH(TRIM(    but000.LEGAL_ORG)) = 0 THEN NULL ELSE    but000.LEGAL_ORG END CUST_LEGAL_ORG,
			but000.FOUND_DAT	CUST_ORG_FOUNDED_DATE,
			but000.LIQUID_DAT	CUST_ORG_LIQUIDATION_DATE,
			CASE WHEN LENGTH(but000.LOCATION_1) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.LOCATION_1, '1234567890', '')), 0) = 0 THEN but000.LOCATION_1 ELSE NULL END CUST_LOC_1,
			CASE WHEN LENGTH(but000.LOCATION_2) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.LOCATION_2, '1234567890', '')), 0) = 0 THEN but000.LOCATION_2 ELSE NULL END CUST_LOC_2,
			CASE WHEN LENGTH(but000.LOCATION_3) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.LOCATION_3, '1234567890', '')), 0) = 0 THEN but000.LOCATION_3 ELSE NULL END CUST_LOC_3,
		CASE WHEN LENGTH(TRIM(but000.NAME_LAST)) = 0 THEN NULL ELSE but000.NAME_LAST END CUST_LAST_NAME,
		CASE WHEN LENGTH(TRIM(    but000.NAME_FIRST)) = 0 THEN NULL ELSE    but000.NAME_FIRST END CUST_FIRST_NAME,
		CASE WHEN LENGTH(TRIM(    but000.NAME_LST2)) = 0 THEN NULL ELSE    but000.NAME_LST2 END CUST_LAST_NAME_2,
		CASE WHEN LENGTH(TRIM(    but000.NAME_LAST2)) = 0 THEN NULL ELSE    but000.NAME_LAST2 END CUST_BIRTH_NAME,
		CASE WHEN LENGTH(TRIM(    but000.NAMEMIDDLE)) = 0 THEN NULL ELSE    but000.NAMEMIDDLE END CUST_MIDDLE_NAME,
		CASE WHEN LENGTH(TRIM(    but000.TITLE_ACA1)) = 0 THEN NULL ELSE    but000.TITLE_ACA1 END CUST_ACADEMIC_TITLE_1,
		CASE WHEN LENGTH(TRIM(    but000.TITLE_ACA2)) = 0 THEN NULL ELSE    but000.TITLE_ACA2 END CUST_ACADEMIC_TITLE_2,
		CASE WHEN LENGTH(TRIM(    but000.TITLE_ROYL)) = 0 THEN NULL ELSE    but000.TITLE_ROYL END CUST_TITLE_SUPPLEMENT,
		CASE WHEN LENGTH(TRIM(    but000.PREFIX1)) = 0 THEN NULL ELSE    but000.PREFIX1 END CUST_PREFIX_1,
		CASE WHEN LENGTH(TRIM(    but000.PREFIX2)) = 0 THEN NULL ELSE    but000.PREFIX2 END CUST_PREFIX_2,
		CASE WHEN LENGTH(TRIM(    but000.NAME1_TEXT)) = 0 THEN NULL ELSE    but000.NAME1_TEXT END CUST_FULL_NAME,
		CASE WHEN LENGTH(TRIM(    but000.NICKNAME)) = 0 THEN NULL ELSE    but000.NICKNAME END CUST_NICKNAME,
		CASE WHEN LENGTH(TRIM(    but000.INITIALS)) = 0 THEN NULL ELSE    but000.INITIALS END CUST_INITIALS,
		CASE WHEN LENGTH(TRIM(    but000.NAMEFORMAT)) = 0 THEN NULL ELSE    but000.NAMEFORMAT END CUST_NAME_FORMAT,
		CASE WHEN LENGTH(TRIM(    but000.NAMCOUNTRY)) = 0 THEN NULL ELSE    but000.NAMCOUNTRY END CUST_NAME_FORMAT_COUNTRY,
		CASE WHEN LENGTH(TRIM(    but000.LANGU_CORR)) = 0 THEN NULL ELSE    but000.LANGU_CORR END CUST_CORRESPONDENCE_LANGUAGE,
		CASE WHEN LENGTH(TRIM(    but000.XSEXM)) = 0 THEN NULL ELSE    but000.XSEXM END CUST_GENDER_MALE,
		CASE WHEN LENGTH(TRIM(    but000.XSEXF)) = 0 THEN NULL ELSE    but000.XSEXF END CUST_GENDER_FEMALE,
		CASE WHEN LENGTH(TRIM(    but000.BIRTHPL)) = 0 THEN NULL ELSE    but000.BIRTHPL END CUST_BIRTHPLACE,
		CASE WHEN LENGTH(TRIM(    but000.MARST)) = 0 THEN NULL ELSE    but000.MARST END CUST_MARITAL_STATUS,
		CASE WHEN LENGTH(TRIM(    but000.EMPLO)) = 0 THEN NULL ELSE    but000.EMPLO END CUST_EMPLOYER,
		CASE WHEN LENGTH(TRIM(    but000.JOBGR)) = 0 THEN NULL ELSE    but000.JOBGR END CUST_OCCUPATION,
		CASE WHEN LENGTH(TRIM(    but000.NATIO)) = 0 THEN NULL ELSE    but000.NATIO END CUST_NATIONALITY,
		CASE WHEN LENGTH(TRIM(    but000.CNDSC)) = 0 THEN NULL ELSE    but000.CNDSC END CUST_CITY_OF_ORIGIN,
		CASE WHEN LENGTH(TRIM(    but000.XSEXU)) = 0 THEN NULL ELSE    but000.XSEXU END CUST_GENDER_UNKNOWN,
		CASE WHEN LENGTH(TRIM(    but000.BU_LANGU)) = 0 THEN NULL ELSE    but000.BU_LANGU END CUST_LANGUAGE,
		but000.BIRTHDT	CUST_DOB,
		CASE WHEN length(but000.ZZNCBIRTHDATE) = 4 and  ISDATE(decode(but000.ZZNCBIRTHDATE,'0000',null,'1896'||but000.ZZNCBIRTHDATE), 'YYYYMMDD') THEN TO_DATE(decode(but000.ZZNCBIRTHDATE,'0000',null,'1896'||but000.ZZNCBIRTHDATE), 'YYYYMMDD') ELSE NULL END CUST_BIRTHDAY,
		but000.DEATHDT	CUST_DATE_OF_DEATH,	
		CASE WHEN LENGTH(TRIM( but000.PARTGRPTYP)) = 0 THEN NULL ELSE but000.PARTGRPTYP END CUST_GROUP_TYPE,
		CASE WHEN LENGTH(TRIM(    but000.NAME_GRP1)) = 0 THEN NULL ELSE    but000.NAME_GRP1 END CUST_GROUP_NAME_1,
		CASE WHEN LENGTH(TRIM(    but000.NAME_GRP2)) = 0 THEN NULL ELSE    but000.NAME_GRP2 END CUST_GROUP_NAME_2,
		CASE WHEN LENGTH(TRIM(    but000.CRUSR)) = 0 THEN NULL ELSE    but000.CRUSR END CUST_CREATE_USER,
		to_timestamp(cast(CRDAT as varchar(20))||cast(CRTIM as varchar(20)), 'yyyy-mm-ddhh24:mi:ss') CUST_CREATE_TS,
		CASE WHEN LENGTH(TRIM(but000.CHUSR)) = 0 THEN NULL ELSE but000.CHUSR END CUST_UPD_USER,
		to_timestamp(cast(CHDAT as varchar(20))||cast(CHTIM as varchar(20)), 'yyyy-mm-ddhh24:mi:ss') CUST_UPD_TS,
		CASE WHEN LENGTH(TRIM( but000.PARTNER_GUID)) = 0 THEN NULL ELSE but000.PARTNER_GUID END CUST_GUID,
		CASE WHEN LENGTH(but000.ADDRCOMM) = 0 THEN NULL WHEN NVL(LENGTH(TRANSLATE(but000.ADDRCOMM, '1234567890', '')), 0) = 0 THEN SUBSTR(but000.ADDRCOMM,1,18) ELSE NULL END CUST_PRIMARY_ADDR_ID,
		decode(but000.VALID_FROM,10101000000,null,TO_TIMESTAMP(but000.VALID_FROM, 'YYYYMMDDHH24MISS'))		CUST_EFF_TS	,
		decode(but000.VALID_TO,99991231235959,null,TO_TIMESTAMP(but000.VALID_TO, 'YYYYMMDDHH24MISS'))		CUST_END_TS	,
		CASE WHEN LENGTH(TRIM(but000.NATPERS)) = 0 THEN NULL ELSE but000.NATPERS END CUST_INDV_IND,
		null CUST_DELETE_TS,
		CASE WHEN LENGTH(TRIM(    but000.ZZHIGH_ISSUE)) = 0 THEN NULL ELSE    but000.ZZHIGH_ISSUE END CUST_HIGH_ISSUE_FLAG,
		/*CASE WHEN LENGTH(TRIM(but000.ZZVETERAN)) = 0 THEN NULL ELSE but000.ZZVETERAN END AS CUST_VETERAN*/ /* DIA-8470 to remove this Column*/
		b.CUST_VETERAN
FROM "+context.NTZ_STG_CRM+"..BUT000 LEFT OUTER JOIN PARTNER_REF ON BUT000.PARTNER = PARTNER_REF.PARTNER 
left join
(
    select partner, max(CASE WHEN LENGTH(TRIM(attr_value)) = 0 THEN NULL ELSE attr_value END) AS      CUST_VETERAN
    from "+context.NTZ_STG_CRM+"..CUSTOMER_ATTRIBUTES
     where attr_set_name = 'CUST_MASTER' and attr_name = 'ISVETERAN'   
	group by 1
) b on BUT000.PARTNER = b.PARTNER   /* DIA-8470 added new join clause to fetch from CUSTOMER_ATTRIBUTES */
WHERE 
BUT000.DB_TS >=  TO_TIMESTAMP(" + TalendDate.formatDate("yyyyMMddHHmmss",context.ctxFromDate) + " ,'yyyyMMddHHmiss')

-----------------------------------------------------------------------------

/*"+ projectName +" "+jobName+" */

merge
into EDW..CRM_CUSTOMER cust
using (	
select 
sap_bp_id,
zzccstatus as cust_consumer_card_status,
case WHEN LENGTH(zzcopendt) = 8 AND ISDATE(zzcopendt, 'YYYYMMDD') THEN TO_DATE(zzcopendt, 'YYYYMMDD') ELSE NULL END
as cust_consumer_card_approval_date, /* DIA-10134 */
zzrwdind as cust_consumer_card_loyalty_ind,
CASE 
WHEN zzccstatus = 'A' then 'X' ELSE 
null END cust_consumer_card_ind
from (
select  cast(partner as bigint) as sap_bp_id, min(zzccstatus) as zzccstatus,min(zzcopendt) as zzcopendt,
max(zzrwdind) as zzrwdind /* DIA- 10280*/
from "+context.NTZ_STG_CRM+"..bp_zzcctoken
where zzcctype='PLCC' /* and db_ts >=  TO_TIMESTAMP(" + TalendDate.formatDate("yyyyMMddHHmmss",context.ctxFromDate) + " ,'yyyyMMddHHmiss') */
and zzcopendt != '0' /* DIA- 10280*/
group by 1) a
) sub
on cust.sap_bp_id=sub.sap_bp_id
when matched then
update set cust.cust_consumer_card_status = sub.cust_consumer_card_status,
cust.cust_consumer_card_approval_date=sub.cust_consumer_card_approval_date,
cust.cust_consumer_card_ind=sub.cust_consumer_card_ind,
cust.cust_consumer_card_loyalty_ind=sub.cust_consumer_card_loyalty_ind

-----------------------------------------------------------------------------

/*"+ projectName +" "+jobName+" */

merge into EDW..CRM_CUSTOMER cust
using (select
cast(b.partner as bigint) as sap_bp_id,
zzccstatus as cust_consumer_card_status,
case WHEN LENGTH(zzcopendt) = 8 AND ISDATE(zzcopendt, 'YYYYMMDD') THEN TO_DATE(zzcopendt, 'YYYYMMDD') ELSE NULL END
as cust_consumer_card_approval_date, /* DIA-10134 */
zzrwdind as cust_consumer_card_loyalty_ind ,
CASE WHEN zzccstatus = 'A' then 'X' ELSE null END cust_consumer_card_ind
from(select b.idnumber clean_id, min(a.zzccstatus) as zzccstatus,min(a.zzcopendt) as zzcopendt,max(a.zzrwdind) as zzrwdind /* DIA- 10280*/
from  "+context.NTZ_STG_CRM+"..bp_zzcctoken a
join  "+context.NTZ_STG_CRM+"..but0id b on a.partner = b.partner and b.id_type = 'ZCLEAN' and b.type = '1' and a.zzcctype='PLCC'
where /* a.DB_TS  >= TO_TIMESTAMP(" + TalendDate.formatDate("yyyyMMddHHmmss",context.ctxFromDate) + " ,'yyyyMMddHHmiss') and */
 a.zzcopendt != '0' /* DIA- 10280*/
group by 1
 ) x
join "+context.NTZ_STG_CRM+"..but0id b on x.clean_id = b.IDNUMBER and b.type = '1' and b.id_type = 'ZCLEAN') sub
on cust.SAP_BP_ID=sub.SAP_BP_ID
when matched then
update set cust.cust_consumer_card_status = sub.cust_consumer_card_status,
cust.cust_consumer_card_approval_date=sub.cust_consumer_card_approval_date,
cust.cust_consumer_card_ind=sub.cust_consumer_card_ind,
cust.cust_consumer_card_loyalty_ind=sub.cust_consumer_card_loyalty_ind

